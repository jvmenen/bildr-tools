/* Copyright 2022, Jeroen van Menen. bildr-tools 0.4.3 (Fri, 24 Jun 2022 06:26:08 GMT) */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Bildr=t():(e.Bildr=e.Bildr||{},e.Bildr.plugins=t())}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{manager:()=>i,pluginBase:()=>s});class i{constructor(){this._registeredPlugins=[]}register(e){if(null==e.name||null==e.name||0==e.name.trim().length)throw new Error("Name is required to register a plugin.");if(i.isRegistered(e.name))throw new Error(`Plugin with name '${e.name}' already registered. Name needs to be unique.`);this.startListeningForMessagesFromIFrame(),this._registeredPlugins.push(e),e.renderPage()}isRegistered(e){return null!=this._registeredPlugins.find((t=>t.name==e))}remove(e){let t=this._registeredPlugins.find((t=>t.name==e));null!=t&&(t.remove(),this._registeredPlugins.forEach(((e,i)=>{e===t&&this._registeredPlugins.splice(i,1)})))}get window(){return window}startListeningForMessagesFromIFrame(){0==this._registeredPlugins.length&&this.window.addEventListener("message",(e=>{this.triggerActionInPlugin(e)}))}triggerActionInPlugin(e){if(!e.data)return;let t=e.data,i=this._registeredPlugins.find((e=>t.pluginName&&e.name==t.pluginName));null!=i&&(null==t.data&&(t.data={}),t.data.uMsgId=t.uMsgId,i.triggerAction(t.command,t.data))}static getInstance(){return null==this._instance&&(this._instance=new i),this._instance}static remove(e){this.getInstance().remove(e)}static isRegistered(e){return this.getInstance().isRegistered(e)}static register(e){this.getInstance().register(e)}}class s{constructor(e,t){this._actions=[],this._name=e,this._pageUrl=t,this._divId=Math.random().toString(16).slice(2),this._frameId=Math.random().toString(16).slice(2)}get name(){return this._name}get divElem(){return this._divElem}isSameDivElem(e){return this._divElem===e}sendOutgoingMessage(e,t){document.getElementById(this._frameId).contentWindow.postMessage({msgId:e,result:t},"*")}triggerAction(e,t){if(null==t.uMsgId||null==t.uMsgId||""==t.uMsgId)throw new Error("uMsgId should be set on argument actionData");let i=this._actions.find((t=>t.name==e));if(null==i)throw new Error(`Unknown action '${e}' on plugin '${this.name}'`);let s=i.execFunc(t);return s&&this.sendOutgoingMessage(t.uMsgId,s),s}hide(){this._divElem.style.right="-400px"}show(){this._divElem.style.width="400px",this._divElem.style.right="0px"}toggleVisibility(){this.isVisible?this.hide():this.show()}get isVisible(){return"0px"==this._divElem.style.right}get document(){return window.document}renderPage(){if(!this._divElem){let e=this.document.createElement("div");e.id=this._divId,e.style.cssText="width:0px;height:100vh;top:0px;left:unset;right:-400px;bottom:unset;border:none;background:#ffffff;position: fixed;z-index: 100010;overflow: hidden;position:absolute;transition: right 300ms ease-in-out 0s;",e.innerHTML=`<iframe id='${this._frameId}' src='${this._pageUrl}' style='all:unset;width:100%;height:100%'></iframe>`,this.document.body.appendChild(e),e.addEventListener("transitionend",(t=>{"0px"!=e.style.right&&(e.style.width="0px")})),this._divElem=e}}remove(){this.document.body.removeChild(this._divElem)}addActionObject(e){this.addAction(e.name,e.execFunc)}addAction(e,t){this._actions.push(new n(e,t))}}class n{constructor(e,t){this.name=e,this._execFunc=t}execFunc(e){return this._execFunc(e)}}return t})()));
//# sourceMappingURL=bildr-plugins.min.js.map