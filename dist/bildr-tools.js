(()=>{"use strict";var o={d:(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(o,e)=>Object.prototype.hasOwnProperty.call(o,e),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},e={};function t(o,e,t){let n=window.BildrDBCacheGet;return null!=n?n(o,e,t):null}o.r(e),o.d(e,{ActionTypes:()=>l,Debug:()=>a,Flows:()=>r});const n=o=>o.sort(((o,e)=>(""+o.name).localeCompare(e.name)));class s{constructor(...o){1===o.length?this.cache=t(o[0],"",""):2===o.length?this.cache=t(!1,o[0],o[1]):this.cache=t(!0,"","")}get actions(){return this.cache.actions.recs}get forms(){return this.cache.forms.recs}get actionTypes(){return this.cache.actionsTypes.recs}get activeForms(){return this.forms.filter((o=>0==o.deleted))}get activeFlows(){return this.actions.filter((o=>"68"==o.type&&0==o.deleted))}get deletedFlows(){return this.actions.filter((o=>"68"==o.type&&0!=o.deleted))}get activeFlowsGroupedByFormID(){return o=this.activeFlows,e=o=>o.formID,o.reduce(((o,t)=>{const n=e(t);return o[n]||(o[n]=[]),o[n].push(t),o}),{});var o,e}get activeElements(){return this.cache.elements.recs.filter((o=>0==o.deleted))}}const i={findUnusedFlows:(o=!0,e=new s(!0))=>{const t=n(e.forms);console.log(`Check ${e.actions.length} flows. This might take a few seconds...`),console.log("You'll see a mesage when checking is finished."),console.log(""),o?console.log("Looking for Unused flows (skipping unused 'Auto Save')"):console.log("Looking for All unused flows"),console.log(""),t.forEach((t=>{if(!t.actions)return;let s=e.activeFlowsGroupedByFormID[t.id];if(s){let l=!1;n(s).forEach((n=>{o&&n.name.includes("Auto Save")||0==i.findUsageOfFlow(n.id,!1,e)&&(l||(l=!0,console.log("Form : "+t.name)),console.log("  Flow : "+n.name))}))}})),console.log(""),console.log("THAT'S IT!")},findUsageOfFlow:(o,e,t=new s(!0))=>{const i=o.toString();let l=!1;function r(o){e&&console.log(o)}let a=t.activeFlows.find((e=>e.id==o));if(!a)return r(`Couldn't find flowID ${o} in project!`),!1;{let e=t.forms.find((o=>a&&o.id==a.formID));r(e?`Flow "${a.name}" on form "${e.name}" is called by:`:`Couldn't find form for flowID ${o} in project!`),r("")}return t.activeForms.forEach((o=>{if(!o.actions)return;let e=t.activeFlowsGroupedByFormID[o.id];if(!e)return;let s=!1;n(e).forEach((e=>{var n;if(new Array,e.opts&&e.opts.arguments){let a=e.opts.arguments.find((o=>"actionsArray"==o.name));a&&(null===(n=a.value)||void 0===n||n.forEach((n=>{let a=n.id&&n.id.toString().endsWith(i);if(a&&(l=!0,s||(s=!0,r("Form : "+o.name)),r(`  Flow : ${e.name} (id: ${e.id})`),r("    as nested flow")),!a){let a=t.actions.find((o=>o.id==n.id));if(a&&a.opts&&a.opts.arguments&&Array.isArray(a.opts.arguments)){let t=a.opts.arguments.find((o=>o.type&&"static.actions"==o.type));t&&t.value.endsWith(i)&&(l=!0,s||(s=!0,r("Form : "+o.name)),r(`  Flow : ${e.name} (id: ${e.id})`),r("    Action : "+(null==a?void 0:a.name)))}}})))}}));let a=Array();!function o(e){null!=e&&e.forEach((e=>{o(e.items),a.push(e)}))}(o.objsTree),n(a).forEach((e=>{e.opts&&e.opts.events&&e.opts.events.filter((o=>o.actID&&o.actID.toString().endsWith(i))).forEach((t=>{l=!0,s||(s=!0,r("Form : "+o.name)),r("  Element : "+e.name),r("    Event : "+t.code)}))}));let c=[];if(o.opts&&(o.opts.autoSaveActionID&&o.opts.autoSaveActionID.toString().endsWith(i)&&c.push("Auto-Save Flow"),o.opts.onLoadAct&&o.opts.onLoadAct.toString().endsWith(i)&&c.push("Page Load Flow"),o.opts.notConnectedActID&&o.opts.notConnectedActID.toString().endsWith(i)&&c.push("Flow to run when connection is lost"),o.opts.reConnectedActID&&o.opts.reConnectedActID.toString().endsWith(i)&&c.push("Flow to run when connection is re-established"),o.opts.notAuthenticatedActID&&o.opts.notAuthenticatedActID.toString().endsWith(i)&&c.push("Flow to run when authentication is lost"),o.opts.newRevisionActID&&o.opts.newRevisionActID.toString().endsWith(i)&&c.push("Flow to Run When Revision is Out of Date"),c.length>0&&(l=!0,r("Form : "+o.name),r("  Element : Page Body"),c.forEach((o=>{r("    Event : "+o)}))),o.opts.resonanceDataListeners)){let e=o.opts.resonanceDataListeners.filter((o=>o.actID&&o.actID.toString().endsWith(i)));e.length>0&&(l=!0,r("Form : "+o.name),r("  Element : Page Body"),r(`    Used by ${e.length} Data Listener(s)`))}})),r(""),r("THAT'S IT!"),l},findUsageOfDeletedFlows:(o=new s(!1))=>{function e(e){return null!=o.deletedFlows.find((o=>o.id.toString().endsWith(e.toString())))}o.activeFlows.forEach((t=>{var n;if(t.opts&&t.opts.arguments){let s=t.opts.arguments.find((o=>"actionsArray"==o.name));s&&(null===(n=s.value)||void 0===n||n.forEach((n=>{if(n.id&&e(n.id)){let e=o.forms.find((o=>o.id==t.formID));if(e){console.log(`Form : ${e.name}`),console.log(`  Flow : ${t.name} (id: ${t.id})`);const s=o.deletedFlows.find((o=>o&&o.id.toString().endsWith(n.id.toString())));console.log(s)}}else{let s=o.actions.find((o=>o.id==n.id));if(s&&s.opts&&s.opts.arguments&&s.opts.arguments.find((o=>o.type&&"static.actions"==o.type&&o.value&&e(o.value)))){let e=o.forms.find((o=>o.id==t.formID));e&&(console.log(`Form : ${e.name}`),console.log(`  Flow : ${t.name} (id: ${t.id})`),console.log(`    Action : ${s.name}`))}}})))}})),o.activeForms.forEach((t=>{var s=Array();!function o(e){null!=e&&e.forEach((e=>{o(e.items),s.push(e)}))}(t.objsTree),n(s).forEach((t=>{t.opts&&t.opts.events&&t.opts.events.filter((o=>o.actID&&e(o.actID))).forEach((e=>{let n=o.forms.find((o=>o.id==t.formID));n&&(console.log("Form : "+n.name),console.log("  Element : "+t.name),console.log("    Event : "+e.code))}))}));let i=[];if(t.opts&&(t.opts.autoSaveActionID&&e(t.opts.autoSaveActionID)&&i.push("Auto-Save Flow"),t.opts.onLoadAct&&e(t.opts.onLoadAct)&&i.push("Page Load Flow"),t.opts.notConnectedActID&&e(t.opts.notConnectedActID)&&i.push("Flow to run when connection is lost"),t.opts.reConnectedActID&&e(t.opts.reConnectedActID)&&i.push("Flow to run when connection is re-established"),t.opts.notAuthenticatedActID&&e(t.opts.notAuthenticatedActID)&&i.push("Flow to run when authentication is lost"),t.opts.newRevisionActID&&e(t.opts.newRevisionActID)&&i.push("Flow to Run When Revision is Out of Date"),i.length>0&&(console.log("Form : "+t.name),console.log("  Element : Page Body"),i.forEach((o=>{console.log("    Event : "+o)}))),t.opts.resonanceDataListeners)){let o=t.opts.resonanceDataListeners.filter((o=>o.actID&&e(o.actID)));o.length>0&&(console.log("Form : "+t.name),console.log("  Element : Page Body"),console.log(`    Used by ${o.length} Data Listener(s)`))}})),console.log(""),console.log("THAT'S IT!")},getFlowWithActions:(o,e=new s(!0))=>{var t;let n=e.activeFlows.find((e=>e.id&&e.id.toString()==o));if(null==n)return console.log("flow not found"),!1;if(console.log("Flow found:"),console.log(n),console.log("Actions:"),n.opts&&n.opts.arguments){let o=n.opts.arguments.find((o=>"actionsArray"==o.name));o&&(null===(t=o.value)||void 0===t||t.forEach((o=>{let t=e.actions.find((e=>e.id.toString()==o.id.toString()));t&&console.log(t)})))}}};let l={findUsage:(o,e=new s(!0))=>{function t(o){console.log(o)}let i=e.actionTypes.find((e=>e.id==o));if(!i)return t(`Couldn't find Action Type ${o} in project!`),!1;t(`Action Type "${i.name}" is called by:`),t(""),e.activeForms.forEach((s=>{if(!s.actions)return;let i=e.activeFlowsGroupedByFormID[s.id];if(!i)return;let l=!1;n(i).forEach((n=>{var i;if(n.opts&&n.opts.arguments){let r=n.opts.arguments.find((o=>"actionsArray"==o.name));if(!r)return;null===(i=r.value)||void 0===i||i.forEach((i=>{let r=e.actions.find((o=>o.id==i.id));r&&r.type&&r.type==o&&(l||(l=!0,t("Form : "+s.name)),t(`  Flow : ${n.name} (id: ${n.id})`),t("    Action : "+r.name))}))}}))})),t(""),t("THAT'S IT!")}},r=i,a={ShowAllVariables:()=>{!function o(e){e&&e.form&&e.form.name&&console.log(`Variables of Page: ${e.form.name}`);let t=e._vars;t&&(console.log(t),e.cBrwForms&&e.cBrwForms.forEach((e=>{o(e)})))}(void 0)}};window.BildrTools=e})();