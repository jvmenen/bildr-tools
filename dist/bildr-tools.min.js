(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{ActionTypes:()=>d,ActionsToShowEnum:()=>h,Debug:()=>u,Flows:()=>g});const o=(e,t)=>e.reduce(((e,o)=>{const n=t(o);return e[n]||(e[n]=[]),e[n].push(o),e}),{}),n=e=>e.sort(((e,t)=>(""+e.name).localeCompare(t.name)));class s{constructor(e,t,o){this.name=e,this.exec=t,this.nullDefault=o,this.clear()}clear(){this.value}getValue(){return null==this.value&&(this.value=this.exec()),this.value?this.value:this.nullDefault}}class i{constructor(){this.cache=[]}register(e,t,o){this.cache.push(new s(e,t,o))}getValue(e){let t=this.cache.find((t=>t.name==e));if(t)return t.getValue();throw new Error("variableName is not defined")}clear(){this.cache.forEach((e=>e.clear()))}}class c{constructor(...e){1===e.length?this.bildrCache=BildrDBCacheGet(e[0],"","",null):2===e.length?this.bildrCache=BildrDBCacheGet(!1,e[0],e[1],null):this.bildrCache=BildrDBCacheGet(!0,"","",null),this.cache=new i,this.cache.register("actionsGroupedByFormID",(()=>o(this.actions,(e=>e.formID))),o([],(()=>""))),this.cache.register("actions",(()=>this.bildrCache.actions.recs.map((e=>new r(e,this)))),Array()),this.cache.register("flows",(()=>this.actions.filter((e=>"68"==e.type)).map((e=>new a(e,this)))),Array()),this.cache.register("elements",(()=>this.bildrCache.elements.recs),Array()),this.cache.register("forms",(()=>this.bildrCache.forms.recs.map((e=>new l(e,this)))),Array()),this.cache.register("actionTypes",(()=>this.bildrCache.actionsTypes.recs),Array()),this.cache.register("activeForms",(()=>this.forms.filter((e=>0==e.deleted&&1!=e.opts.archived))),Array()),this.cache.register("activeFlows",(()=>this.flows.filter((e=>0==e.deleted))),Array()),this.cache.register("deletedFlows",(()=>this.flows.filter((e=>0!=e.deleted))),Array()),this.cache.register("activeFlowsGroupedByFormID",(()=>o(this.activeFlows,(e=>e.formID))),o([],(()=>""))),this.cache.register("activeElements",(()=>this.elements.filter((e=>0==e.deleted))),Array())}get actions(){return this.cache.getValue("actions")}get flows(){return this.cache.getValue("flows")}get elements(){return this.cache.getValue("elements")}get forms(){return this.cache.getValue("forms")}get actionTypes(){return this.cache.getValue("actionTypes")}get activeForms(){return this.cache.getValue("activeForms")}get activeFlows(){return this.cache.getValue("activeFlows")}get deletedFlows(){return this.cache.getValue("deletedFlows")}get activeFlowsGroupedByFormID(){return this.cache.getValue("activeFlowsGroupedByFormID")}get actionsGroupedByFormID(){return this.cache.getValue("actionsGroupedByFormID")}get activeElements(){return this.cache.getValue("activeElements")}}c.createInstance=()=>new c(!0);class l{constructor(e,t){this.opts=e.opts,this.objsTree=e.objsTree,this.actions=e.actions,this.deleted=e.deleted,this.name=e.name,this.id=e.id,this.bildrCache=t}get ActiveFlows(){return this.bildrCache.activeFlowsGroupedByFormID[this.id.toString()]||Array()}get ActiveElements(){let e=Array();return function t(o){null!=o&&o.forEach((o=>{t(o.items),e.push(o)}))}(this.objsTree),e}}class r{constructor(e,t){this.opts=e.opts,this.formID=e.formID,this.type=e.type,this.deleted=e.deleted,this.name=e.name,this.id=e.id,this.bildrCache=t}get Form(){return this.form||(this.form=this.bildrCache.forms.find((e=>e.id==this.formID))),this.form}get Arguments(){return this.opts.arguments}}class a extends r{constructor(e,t){super(e,t)}get Actions(){let e=this.opts.arguments.find((e=>"actionsArray"==e.name)),t=Array();if(!e)return t;let o=e;return o.value?(o.value.forEach((e=>{let o=this.bildrCache.actionsGroupedByFormID[this.formID].find((t=>t.id==e.id));o&&t.push(o)})),t):t}}class d{static findUsage(e){let t=c.createInstance();function o(e){console.log(e)}let s=t.actionTypes.find((t=>t.id==e));s?(o(`Action Type "${s.name}" is called by:`),o(""),t.activeForms.forEach((t=>{let s=!1;n(t.ActiveFlows).forEach((n=>{n.Actions.forEach((i=>{i.type==e&&(s||(s=!0,o("Form : "+t.name)),o(`  Flow : ${n.name} (id: ${n.id})`),o("    Action : "+i.name))}))}))})),o(""),o("THAT'S IT!")):o(`Couldn't find Action Type ${e} in project!`)}}var h;!function(e){e[e.Flows=1]="Flows",e[e.Actions=2]="Actions",e[e.BildrActions=4]="BildrActions",e[e.MouseActions=8]="MouseActions"}(h||(h={}));class u{static ShowAllVariables(){!function e(t){t&&t.form&&t.form.name&&console.log(`Variables of Page: ${t.form.name}`);let o=t._vars;o&&(console.log(o),t.cBrwForms&&t.cBrwForms.forEach((t=>{e(t)})))}(brwFormRoot)}static Start(e){window.orgQAFunc||(window.orgQAFunc=QueueAction),window.QueueAction=function(t,o,n,s,i,l,r,a,d){let g=(u.ActionsToShow&h.Flows)===h.Flows,f=(u.ActionsToShow&h.Actions)===h.Actions,m=(u.ActionsToShow&h.BildrActions)===h.BildrActions,w=(u.ActionsToShow&h.MouseActions)===h.MouseActions;if(t){let o="V3gKt5FZRECIDMudjBbi3g"==t.id||"AGTUwIokUuQgXEgNW6mnA"==t.id||"CAGTUwIokUuQgXEgNW6mnA"==t.id,n="68"==t.type;if(o&&w||n&&g||!o&&!n&&f){let o;if(t.id&&!m&&(o=c.createInstance().actions.find((e=>e.id==t.id))),null!=o||m){let o=n?"Flow  ":"Action",s=n?"":"  --";console.log(`${o}: ${t.id} ${s}  "${t.name}"`),(u._StepMode||e&&t.id==e)&&(u._StepMode=!0)}}}window.orgQAFunc.call(this,t,o,n,s,i,l,r,a,d)},window.QueueAction.prototype=window.orgQAFunc.prototype,window.QueueAction.prototype.constructor=QueueAction}static Stop(){window.orgQAFunc&&(window.QueueAction=window.orgQAFunc)}static StepModeOff(){u._StepMode=!1}}u._StepMode=!1,u.ActionsToShow=h.Flows;class g{static findUnusedFlows(e=!0){let t=c.createInstance();const o=n(t.activeForms);console.log(`Checking ${t.activeFlows.length} flows.`),console.log("You'll see 'That's it!' when checking is finished."),console.log(""),e?console.log("Looking for Unused flows (skipping unused 'Auto Save')"):console.log("Looking for All unused flows"),console.log(""),o.forEach((t=>{let o=!1;n(t.ActiveFlows).forEach((n=>{e&&n.name.includes("Auto Save")||0==g.findUsageOfFlow(n.id,!1)&&(o||(o=!0,console.log("Form : "+t.name)),console.log("  Flow : "+n.name))}))})),console.log(""),console.log("THAT'S IT!")}static findUsageOfFlow(e,t=!0){let o=c.createInstance();const s=e.toString();let i=!1;function l(e){t&&console.log(e)}let r=o.activeFlows.find((t=>t.id==e));return r?(r.Form?l(`Flow "${r.name}" on form "${r.Form.name}" is called by:`):l(`Couldn't find form for flowID ${e} in project!`),l(""),o.activeForms.forEach((e=>{var t,o,c,r,a,d;let h=!1;n(e.ActiveFlows).forEach((t=>{t.Actions.forEach((o=>{o.id.toString().endsWith(s)?(i=!0,h||(h=!0,l("Form : "+e.name)),l(`  Flow : ${t.name} (id: ${t.id})`),l("    as nested flow")):o.Arguments.forEach((n=>{"static.actions"==n.type&&n.value.endsWith(s)&&(i=!0,h||(h=!0,l("Form : "+e.name)),l(`  Flow : ${t.name} (id: ${t.id})`),l("    Action : "+o.name))}))}))})),n(e.ActiveElements).forEach((t=>{t.opts.events.filter((e=>e.actID&&e.actID.toString().endsWith(s))).forEach((o=>{i=!0,h||(h=!0,l("Form : "+e.name)),l("  Element : "+t.name),l("    Event : "+o.code)}))}));let u=[];if((null===(t=e.opts.autoSaveActionID)||void 0===t?void 0:t.toString().endsWith(s))&&u.push("Auto-Save Flow"),(null===(o=e.opts.onLoadAct)||void 0===o?void 0:o.toString().endsWith(s))&&u.push("Page Load Flow"),(null===(c=e.opts.notConnectedActID)||void 0===c?void 0:c.toString().endsWith(s))&&u.push("Flow to run when connection is lost"),(null===(r=e.opts.reConnectedActID)||void 0===r?void 0:r.toString().endsWith(s))&&u.push("Flow to run when connection is re-established"),(null===(a=e.opts.notAuthenticatedActID)||void 0===a?void 0:a.toString().endsWith(s))&&u.push("Flow to run when authentication is lost"),(null===(d=e.opts.newRevisionActID)||void 0===d?void 0:d.toString().endsWith(s))&&u.push("Flow to Run When Revision is Out of Date"),u.length>0&&(i=!0,l("Form : "+e.name),l("  Element : Page Body"),u.forEach((e=>{l("    Event : "+e)}))),e.opts.resonanceDataListeners){let t=e.opts.resonanceDataListeners.filter((e=>e.actID&&e.actID.toString().endsWith(s)));t.length>0&&(i=!0,l("Form : "+e.name),l("  Element : Page Body"),l(`    Used by ${t.length} Data Listener(s)`))}})),l(""),l("THAT'S IT!"),i):(l(`Couldn't find flowID ${e} in project!`),!1)}static findUsageOfDeletedFlows(){let e=c.createInstance();function t(t){return null!=e.deletedFlows.find((e=>e.id.toString().endsWith(t.toString())))}e.activeFlows.forEach((o=>{var n;if(o.opts&&o.opts.arguments){let s=o.opts.arguments.find((e=>"actionsArray"==e.name));s&&(null===(n=s.value)||void 0===n||n.forEach((n=>{if(n.id&&t(n.id)){let t=e.forms.find((e=>e.id==o.formID));if(t){console.log(`Form : ${t.name}`),console.log(`  Flow : ${o.name} (id: ${o.id})`);const s=e.deletedFlows.find((e=>e&&e.id.toString().endsWith(n.id.toString())));console.log(s)}}else{let s=e.actions.find((e=>e.id==n.id));if(s&&s.opts&&s.opts.arguments&&s.opts.arguments.find((e=>e.type&&"static.actions"==e.type&&e.value&&t(e.value)))){let t=e.forms.find((e=>e.id==o.formID));t&&(console.log(`Form : ${t.name}`),console.log(`  Flow : ${o.name} (id: ${o.id})`),console.log(`    Action : ${s.name}`))}}})))}})),e.activeForms.forEach((o=>{var s=Array();!function e(t){null!=t&&t.forEach((t=>{e(t.items),s.push(t)}))}(o.objsTree),n(s).forEach((o=>{o.opts&&o.opts.events&&o.opts.events.filter((e=>e.actID&&t(e.actID))).forEach((t=>{let n=e.forms.find((e=>e.id==o.formID));n&&(console.log("Form : "+n.name),console.log("  Element : "+o.name),console.log("    Event : "+t.code))}))}));let i=[];if(o.opts&&(o.opts.autoSaveActionID&&t(o.opts.autoSaveActionID)&&i.push("Auto-Save Flow"),o.opts.onLoadAct&&t(o.opts.onLoadAct)&&i.push("Page Load Flow"),o.opts.notConnectedActID&&t(o.opts.notConnectedActID)&&i.push("Flow to run when connection is lost"),o.opts.reConnectedActID&&t(o.opts.reConnectedActID)&&i.push("Flow to run when connection is re-established"),o.opts.notAuthenticatedActID&&t(o.opts.notAuthenticatedActID)&&i.push("Flow to run when authentication is lost"),o.opts.newRevisionActID&&t(o.opts.newRevisionActID)&&i.push("Flow to Run When Revision is Out of Date"),i.length>0&&(console.log("Form : "+o.name),console.log("  Element : Page Body"),i.forEach((e=>{console.log("    Event : "+e)}))),o.opts.resonanceDataListeners)){let e=o.opts.resonanceDataListeners.filter((e=>e.actID&&t(e.actID)));e.length>0&&(console.log("Form : "+o.name),console.log("  Element : Page Body"),console.log(`    Used by ${e.length} Data Listener(s)`))}})),console.log(""),console.log("THAT'S IT!")}static getFlowWithActions(e){var t;let o=c.createInstance(),n=o.activeFlows.find((t=>t.id&&t.id.toString()==e));if(null!=n){if(console.log("Flow found:"),console.log(n),console.log("Actions:"),n.opts&&n.opts.arguments){let e=n.opts.arguments.find((e=>"actionsArray"==e.name));e&&(null===(t=e.value)||void 0===t||t.forEach((e=>{let t=o.actions.find((t=>t.id.toString()==e.id.toString()));t&&console.log(t)})))}}else console.log("flow not found")}}window.BildrTools=t})();