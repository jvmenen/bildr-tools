(()=>{"use strict";var o={d:(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(o,e)=>Object.prototype.hasOwnProperty.call(o,e),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},e={};o.r(e),o.d(e,{ActionTypes:()=>s,ActionsToShowEnum:()=>i,Debug:()=>l,Flows:()=>c});const t=o=>o.sort(((o,e)=>(""+o.name).localeCompare(e.name)));class n{constructor(...o){1===o.length?this.cache=BildrDBCacheGet(o[0],"","",null):2===o.length?this.cache=BildrDBCacheGet(!1,o[0],o[1],null):this.cache=BildrDBCacheGet(!0,"","",null)}get actions(){return this.cache.actions.recs}get forms(){return this.cache.forms.recs}get actionTypes(){return this.cache.actionsTypes.recs}get activeForms(){return this.forms.filter((o=>0==o.deleted))}get activeFlows(){return this.actions.filter((o=>"68"==o.type&&0==o.deleted))}get deletedFlows(){return this.actions.filter((o=>"68"==o.type&&0!=o.deleted))}get activeFlowsGroupedByFormID(){return o=this.activeFlows,e=o=>o.formID,o.reduce(((o,t)=>{const n=e(t);return o[n]||(o[n]=[]),o[n].push(t),o}),{});var o,e}get activeElements(){return this.cache.elements.recs.filter((o=>0==o.deleted))}}n.createInstance=()=>new n(!0);class s{static findUsage(o){let e=n.createInstance();function s(o){console.log(o)}let i=e.actionTypes.find((e=>e.id==o));i?(s(`Action Type "${i.name}" is called by:`),s(""),e.activeForms.forEach((n=>{if(!n.actions)return;let i=e.activeFlowsGroupedByFormID[n.id];if(!i)return;let l=!1;t(i).forEach((t=>{var i;if(t.opts&&t.opts.arguments){let c=t.opts.arguments.find((o=>"actionsArray"==o.name));if(!c)return;null===(i=c.value)||void 0===i||i.forEach((i=>{let c=e.actions.find((o=>o.id==i.id));c&&c.type&&c.type==o&&(l||(l=!0,s("Form : "+n.name)),s(`  Flow : ${t.name} (id: ${t.id})`),s("    Action : "+c.name))}))}}))})),s(""),s("THAT'S IT!")):s(`Couldn't find Action Type ${o} in project!`)}}var i;!function(o){o[o.Flows=1]="Flows",o[o.Actions=2]="Actions",o[o.BildrActions=4]="BildrActions",o[o.MouseActions=8]="MouseActions"}(i||(i={}));class l{static ShowAllVariables(){!function o(e){e&&e.form&&e.form.name&&console.log(`Variables of Page: ${e.form.name}`);let t=e._vars;t&&(console.log(t),e.cBrwForms&&e.cBrwForms.forEach((e=>{o(e)})))}(brwFormRoot)}static Start(o){window.orgQAFunc||(window.orgQAFunc=QueueAction),window.QueueAction=function(e,t,s,c,a,r,d,u,f){let g=(l.ActionsToShow&i.Flows)===i.Flows,m=(l.ActionsToShow&i.Actions)===i.Actions,h=(l.ActionsToShow&i.BildrActions)===i.BildrActions,p=(l.ActionsToShow&i.MouseActions)===i.MouseActions;if(e){let t="V3gKt5FZRECIDMudjBbi3g"==e.id||"AGTUwIokUuQgXEgNW6mnA"==e.id||"CAGTUwIokUuQgXEgNW6mnA"==e.id,s="68"==e.type;if(t&&p||s&&g||!t&&!s&&m){let t;if(e.id&&!h&&(t=n.createInstance().actions.find((o=>o.id==e.id))),null!=t||h){let t=s?"Flow  ":"Action",n=s?"":"  --";console.log(`${t}: ${e.id} ${n}  "${e.name}"`),(l._StepMode||o&&e.id==o)&&(l._StepMode=!0)}}}window.orgQAFunc.call(this,e,t,s,c,a,r,d,u,f)},window.QueueAction.prototype=window.orgQAFunc.prototype,window.QueueAction.prototype.constructor=QueueAction}static Stop(){window.orgQAFunc&&(window.QueueAction=window.orgQAFunc)}static StepModeOff(){l._StepMode=!1}}l._StepMode=!1,l.ActionsToShow=i.Flows;class c{static findUnusedFlows(o=!0){let e=n.createInstance();const s=t(e.forms);console.log(`Check ${e.actions.length} flows. This might take a few seconds...`),console.log("You'll see a mesage when checking is finished."),console.log(""),o?console.log("Looking for Unused flows (skipping unused 'Auto Save')"):console.log("Looking for All unused flows"),console.log(""),s.forEach((n=>{if(!n.actions)return;let s=e.activeFlowsGroupedByFormID[n.id];if(s){let e=!1;t(s).forEach((t=>{o&&t.name.includes("Auto Save")||0==c.findUsageOfFlow(t.id,!1)&&(e||(e=!0,console.log("Form : "+n.name)),console.log("  Flow : "+t.name))}))}})),console.log(""),console.log("THAT'S IT!")}static findUsageOfFlow(o,e=!0){let s=n.createInstance();const i=o.toString();let l=!1;function c(o){e&&console.log(o)}let a=s.activeFlows.find((e=>e.id==o));if(!a)return c(`Couldn't find flowID ${o} in project!`),!1;{let e=s.forms.find((o=>a&&o.id==a.formID));c(e?`Flow "${a.name}" on form "${e.name}" is called by:`:`Couldn't find form for flowID ${o} in project!`),c("")}return s.activeForms.forEach((o=>{var e,n,a,r,d,u;if(!o.actions)return;let f=s.activeFlowsGroupedByFormID[o.id];if(!f)return;let g=!1;t(f).forEach((e=>{var t;if(new Array,e.opts&&e.opts.arguments){let n=e.opts.arguments.find((o=>"actionsArray"==o.name));n&&(null===(t=n.value)||void 0===t||t.forEach((t=>{let n=t.id&&t.id.toString().endsWith(i);if(n&&(l=!0,g||(g=!0,c("Form : "+o.name)),c(`  Flow : ${e.name} (id: ${e.id})`),c("    as nested flow")),!n){let n=s.actions.find((o=>o.id==t.id));if(n&&n.opts&&n.opts.arguments&&Array.isArray(n.opts.arguments)){let t=n.opts.arguments.find((o=>o.type&&"static.actions"==o.type));t&&t.value.endsWith(i)&&(l=!0,g||(g=!0,c("Form : "+o.name)),c(`  Flow : ${e.name} (id: ${e.id})`),c("    Action : "+(null==n?void 0:n.name)))}}})))}}));let m=Array();!function o(e){null!=e&&e.forEach((e=>{o(e.items),m.push(e)}))}(o.objsTree),t(m).forEach((e=>{e.opts&&e.opts.events&&e.opts.events.filter((o=>o.actID&&o.actID.toString().endsWith(i))).forEach((t=>{l=!0,g||(g=!0,c("Form : "+o.name)),c("  Element : "+e.name),c("    Event : "+t.code)}))}));let h=[];if((null===(e=o.opts.autoSaveActionID)||void 0===e?void 0:e.toString().endsWith(i))&&h.push("Auto-Save Flow"),(null===(n=o.opts.onLoadAct)||void 0===n?void 0:n.toString().endsWith(i))&&h.push("Page Load Flow"),(null===(a=o.opts.notConnectedActID)||void 0===a?void 0:a.toString().endsWith(i))&&h.push("Flow to run when connection is lost"),(null===(r=o.opts.reConnectedActID)||void 0===r?void 0:r.toString().endsWith(i))&&h.push("Flow to run when connection is re-established"),(null===(d=o.opts.notAuthenticatedActID)||void 0===d?void 0:d.toString().endsWith(i))&&h.push("Flow to run when authentication is lost"),(null===(u=o.opts.newRevisionActID)||void 0===u?void 0:u.toString().endsWith(i))&&h.push("Flow to Run When Revision is Out of Date"),h.length>0&&(l=!0,c("Form : "+o.name),c("  Element : Page Body"),h.forEach((o=>{c("    Event : "+o)}))),o.opts.resonanceDataListeners){let e=o.opts.resonanceDataListeners.filter((o=>o.actID&&o.actID.toString().endsWith(i)));e.length>0&&(l=!0,c("Form : "+o.name),c("  Element : Page Body"),c(`    Used by ${e.length} Data Listener(s)`))}})),c(""),c("THAT'S IT!"),l}static findUsageOfDeletedFlows(){let o=n.createInstance();function e(e){return null!=o.deletedFlows.find((o=>o.id.toString().endsWith(e.toString())))}o.activeFlows.forEach((t=>{var n;if(t.opts&&t.opts.arguments){let s=t.opts.arguments.find((o=>"actionsArray"==o.name));s&&(null===(n=s.value)||void 0===n||n.forEach((n=>{if(n.id&&e(n.id)){let e=o.forms.find((o=>o.id==t.formID));if(e){console.log(`Form : ${e.name}`),console.log(`  Flow : ${t.name} (id: ${t.id})`);const s=o.deletedFlows.find((o=>o&&o.id.toString().endsWith(n.id.toString())));console.log(s)}}else{let s=o.actions.find((o=>o.id==n.id));if(s&&s.opts&&s.opts.arguments&&s.opts.arguments.find((o=>o.type&&"static.actions"==o.type&&o.value&&e(o.value)))){let e=o.forms.find((o=>o.id==t.formID));e&&(console.log(`Form : ${e.name}`),console.log(`  Flow : ${t.name} (id: ${t.id})`),console.log(`    Action : ${s.name}`))}}})))}})),o.activeForms.forEach((n=>{var s=Array();!function o(e){null!=e&&e.forEach((e=>{o(e.items),s.push(e)}))}(n.objsTree),t(s).forEach((t=>{t.opts&&t.opts.events&&t.opts.events.filter((o=>o.actID&&e(o.actID))).forEach((e=>{let n=o.forms.find((o=>o.id==t.formID));n&&(console.log("Form : "+n.name),console.log("  Element : "+t.name),console.log("    Event : "+e.code))}))}));let i=[];if(n.opts&&(n.opts.autoSaveActionID&&e(n.opts.autoSaveActionID)&&i.push("Auto-Save Flow"),n.opts.onLoadAct&&e(n.opts.onLoadAct)&&i.push("Page Load Flow"),n.opts.notConnectedActID&&e(n.opts.notConnectedActID)&&i.push("Flow to run when connection is lost"),n.opts.reConnectedActID&&e(n.opts.reConnectedActID)&&i.push("Flow to run when connection is re-established"),n.opts.notAuthenticatedActID&&e(n.opts.notAuthenticatedActID)&&i.push("Flow to run when authentication is lost"),n.opts.newRevisionActID&&e(n.opts.newRevisionActID)&&i.push("Flow to Run When Revision is Out of Date"),i.length>0&&(console.log("Form : "+n.name),console.log("  Element : Page Body"),i.forEach((o=>{console.log("    Event : "+o)}))),n.opts.resonanceDataListeners)){let o=n.opts.resonanceDataListeners.filter((o=>o.actID&&e(o.actID)));o.length>0&&(console.log("Form : "+n.name),console.log("  Element : Page Body"),console.log(`    Used by ${o.length} Data Listener(s)`))}})),console.log(""),console.log("THAT'S IT!")}static getFlowWithActions(o){var e;let t=n.createInstance(),s=t.activeFlows.find((e=>e.id&&e.id.toString()==o));if(null!=s){if(console.log("Flow found:"),console.log(s),console.log("Actions:"),s.opts&&s.opts.arguments){let o=s.opts.arguments.find((o=>"actionsArray"==o.name));o&&(null===(e=o.value)||void 0===e||e.forEach((o=>{let e=t.actions.find((e=>e.id.toString()==o.id.toString()));e&&console.log(e)})))}}else console.log("flow not found")}}window.BildrTools=e})();